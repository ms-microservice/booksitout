FROM adoptopenjdk/openjdk11

MAINTAINER JINKYUM PARK
WORKDIR ./

ARG JAR_FILE_PATH=./build/libs/*.jar

ARG DB_URL
ARG DB_ID
ARG DB_PW
ARG EMAIL_HOST
ARG EMAIL_PORT
ARG EMAIL_ID
ARG EMAIL_PW
ARG JWT_SECRET

ARG OAUTH_KAKAO_CLIENT_ID
ARG OAUTH_NAVER_CLIENT_ID
ARG OAUTH_NAVER_CLIENT_SECRET
ARG OAUTH_GOOGLE_CLIENT_ID
ARG OAUTH_GOOGLE_CLIENT_SECRET

ENV DB_URL=$DB_URL
ENV DB_ID=$DB_ID
ENV DB_PW=$DB_PW
ENV EMAIL_HOST=$EMAIL_HOST
ENV EMAIL_PORT=$EMAIL_PORT
ENV EMAIL_ID=$EMAIL_ID
ENV EMAIL_PW=$EMAIL_PW
ENV JWT_SECRET=$JWT_SECRET
ENV OAUTH_KAKAO_CLIENT_ID=$OAUTH_KAKAO_CLIENT_ID
ENV OAUTH_NAVER_CLIENT_ID=$OAUTH_NAVER_CLIENT_ID
ENV OAUTH_NAVER_CLIENT_SECRET=$OAUTH_NAVER_CLIENT_SECRET
ENV OAUTH_GOOGLE_CLIENT_ID=$OAUTH_GOOGLE_CLIENT_ID
ENV OAUTH_GOOGLE_CLIENT_SECRET=$OAUTH_GOOGLE_CLIENT_SECRET

EXPOSE 8200

CMD ["./mvnw", "clean", "build"]
COPY ${JAR_FILE_PATH} ./booksitout.jar
ENTRYPOINT ["java", "-jar", "booksitout.jar"]